// Language translations
const translations = {
    en: {
        // Navigation
        "Home": "Home",
        "About": "About",
        "Projects": "Projects",
        "Skills": "Skills",
        "Resume": "Resume",
        "Blog": "Blog",
        "Contact": "Contact",
        
        // Home Section
        "Ahmed Rabea": "Ahmed Rabea",
        "Software Engineer": "Software Engineer",
        "Passionate about creating innovative solutions through code. Specializing in web development, mobile apps, AI, and machine learning.": "Passionate about creating innovative solutions through code. Specializing in web development, mobile apps, AI, and machine learning.",
        "View My Work": "View My Work",
        "Get In Touch": "Get In Touch",
        
        // About Section
        "About Me": "About Me",
        "Hello! I'm Ahmed Rabea": "Hello! I'm Ahmed Rabea",
        "I'm a passionate software engineer with over 5 years of experience in developing innovative web and mobile applications. My journey in technology started with a curiosity about how things work, which led me to pursue computer science and specialize in cutting-edge technologies.": "I'm a passionate software engineer with over 5 years of experience in developing innovative web and mobile applications. My journey in technology started with a curiosity about how things work, which led me to pursue computer science and specialize in cutting-edge technologies.",
        "I specialize in full-stack web development, Flutter mobile development, and have a growing expertise in AI and machine learning. I believe in writing clean, efficient code and creating user experiences that make a difference.": "I specialize in full-stack web development, Flutter mobile development, and have a growing expertise in AI and machine learning. I believe in writing clean, efficient code and creating user experiences that make a difference.",
        "Projects Completed": "Projects Completed",
        "Years Experience": "Years Experience",
        
        // Projects Section
        "Featured Projects": "Featured Projects",
        "Here are some of my recent projects that showcase my skills and passion for development.": "Here are some of my recent projects that showcase my skills and passion for development.",
        "E-Commerce Platform": "E-Commerce Platform",
        "A full-stack e-commerce solution built with React, Node.js, and MongoDB. Features include user authentication, payment integration, and admin dashboard.": "A full-stack e-commerce solution built with React, Node.js, and MongoDB. Features include user authentication, payment integration, and admin dashboard.",
        "Flutter Task Manager": "Flutter Task Manager",
        "A cross-platform mobile app for task management with real-time synchronization, built using Flutter and Firebase.": "A cross-platform mobile app for task management with real-time synchronization, built using Flutter and Firebase.",
        "AI Image Classifier": "AI Image Classifier",
        "A machine learning web application that classifies images using TensorFlow.js, with a user-friendly interface and real-time predictions.": "A machine learning web application that classifies images using TensorFlow.js, with a user-friendly interface and real-time predictions.",
        "Live Demo": "Live Demo",
        "GitHub": "GitHub",
        "App Store": "App Store",
        
        // Skills Section
        "Skills & Technologies": "Skills & Technologies",
        "Technologies and tools I work with to bring ideas to life.": "Technologies and tools I work with to bring ideas to life.",
        "Frontend": "Frontend",
        "Backend": "Backend",
        "Mobile": "Mobile",
        "AI/ML": "AI/ML",
        
        // Resume Section
        "Resume": "Resume",
        "My professional journey and achievements.": "My professional journey and achievements.",
        "Education": "Education",
        "Experience": "Experience",
        "Bachelor of Computer Science": "Bachelor of Computer Science",
        "Cairo University": "Cairo University",
        "Graduated with honors. Specialized in Software Engineering and Artificial Intelligence.": "Graduated with honors. Specialized in Software Engineering and Artificial Intelligence.",
        "Full Stack Web Development Certification": "Full Stack Web Development Certification",
        "Comprehensive training in modern web technologies and best practices.": "Comprehensive training in modern web technologies and best practices.",
        "Senior Software Engineer": "Senior Software Engineer",
        "Tech Solutions Inc.": "Tech Solutions Inc.",
        "Leading a team of developers in building scalable web applications and mobile solutions for enterprise clients.": "Leading a team of developers in building scalable web applications and mobile solutions for enterprise clients.",
        "Full Stack Developer": "Full Stack Developer",
        "Digital Innovations Ltd.": "Digital Innovations Ltd.",
        "Developed and maintained multiple web applications using React, Node.js, and cloud technologies.": "Developed and maintained multiple web applications using React, Node.js, and cloud technologies.",
        "Download Resume": "Download Resume",
        
        // Blog Section
        "Latest Blog Posts": "Latest Blog Posts",
        "Sharing insights and knowledge about technology and development.": "Sharing insights and knowledge about technology and development.",
        "Building Scalable React Applications": "Building Scalable React Applications",
        "Learn best practices for structuring and scaling React applications for enterprise-level projects.": "Learn best practices for structuring and scaling React applications for enterprise-level projects.",
        "Flutter State Management Guide": "Flutter State Management Guide",
        "A comprehensive guide to different state management solutions in Flutter and when to use each one.": "A comprehensive guide to different state management solutions in Flutter and when to use each one.",
        "Getting Started with TensorFlow.js": "Getting Started with TensorFlow.js",
        "Learn how to implement machine learning models directly in the browser using TensorFlow.js.": "Learn how to implement machine learning models directly in the browser using TensorFlow.js.",
        "Read More →": "Read More →",
        
        // Contact Section
        "Get In Touch": "Get In Touch",
        "Let's discuss your next project or just say hello!": "Let's discuss your next project or just say hello!",
        "Email": "Email",
        "Phone": "Phone",
        "Location": "Location",
        "Cairo, Egypt": "Cairo, Egypt",
        "Name": "Name",
        "Your Name": "Your Name",
        "Email": "Email",
        "your@email.com": "your@email.com",
        "Subject": "Subject",
        "Project Discussion": "Project Discussion",
        "Message": "Message",
        "Tell me about your project...": "Tell me about your project...",
        "Send Message": "Send Message",
        
        // Footer
        "Building the future, one line of code at a time.": "Building the future, one line of code at a time.",
        "© 2024 Ahmed Rabea. All rights reserved.": "© 2024 Ahmed Rabea. All rights reserved."
    },
    ar: {
        // Navigation
        "Home": "الرئيسية",
        "About": "من أنا",
        "Projects": "المشاريع",
        "Skills": "المهارات",
        "Resume": "السيرة الذاتية",
        "Blog": "المدونة",
        "Contact": "تواصل معي",
        
        // Home Section
        "Ahmed Rabea": "أحمد ربيع",
        "Software Engineer": "مهندس برمجيات",
        "Passionate about creating innovative solutions through code. Specializing in web development, mobile apps, AI, and machine learning.": "شغوف بإنشاء حلول مبتكرة من خلال البرمجة. متخصص في تطوير الويب والتطبيقات المحمولة والذكاء الاصطناعي والتعلم الآلي.",
        "View My Work": "اطلع على أعمالي",
        "Get In Touch": "تواصل معي",
        
        // About Section
        "About Me": "من أنا",
        "Hello! I'm Ahmed Rabea": "مرحباً! أنا أحمد ربيع",
        "I'm a passionate software engineer with over 5 years of experience in developing innovative web and mobile applications. My journey in technology started with a curiosity about how things work, which led me to pursue computer science and specialize in cutting-edge technologies.": "أنا مهندس برمجيات شغوف بخبرة تزيد عن 5 سنوات في تطوير تطبيقات الويب والهاتف المحمول المبتكرة. بدأت رحلتي في التكنولوجيا بالفضول حول كيفية عمل الأشياء، مما دفعني لدراسة علوم الكمبيوتر والتخصص في التقنيات المتطورة.",
        "I specialize in full-stack web development, Flutter mobile development, and have a growing expertise in AI and machine learning. I believe in writing clean, efficient code and creating user experiences that make a difference.": "أتخصص في تطوير الويب الشامل وتطوير تطبيقات Flutter المحمولة، ولدي خبرة متنامية في الذكاء الاصطناعي والتعلم الآلي. أؤمن بكتابة كود نظيف وفعال وإنشاء تجارب مستخدم تحدث فرقاً.",
        "Projects Completed": "مشروع مكتمل",
        "Years Experience": "سنوات خبرة",
        
        // Projects Section
        "Featured Projects": "المشاريع المميزة",
        "Here are some of my recent projects that showcase my skills and passion for development.": "إليك بعض مشاريعي الحديثة التي تُظهر مهاراتي وشغفي بالتطوير.",
        "E-Commerce Platform": "منصة التسوق الإلكتروني",
        "A full-stack e-commerce solution built with React, Node.js, and MongoDB. Features include user authentication, payment integration, and admin dashboard.": "حل شامل للتجارة الإلكترونية مبني بـ React و Node.js و MongoDB. يتضمن ميزات مثل تسجيل المستخدمين وتكامل الدفع ولوحة تحكم المشرف.",
        "Flutter Task Manager": "مدير المهام Flutter",
        "A cross-platform mobile app for task management with real-time synchronization, built using Flutter and Firebase.": "تطبيق محمول متعدد المنصات لإدارة المهام مع مزامنة في الوقت الفعلي، مبني باستخدام Flutter و Firebase.",
        "AI Image Classifier": "مصنف الصور بالذكاء الاصطناعي",
        "A machine learning web application that classifies images using TensorFlow.js, with a user-friendly interface and real-time predictions.": "تطبيق ويب للتعلم الآلي يصنف الصور باستخدام TensorFlow.js، مع واجهة سهلة الاستخدام وتنبؤات في الوقت الفعلي.",
        "Live Demo": "عرض مباشر",
        "GitHub": "GitHub",
        "App Store": "متجر التطبيقات",
        
        // Skills Section
        "Skills & Technologies": "المهارات والتقنيات",
        "Technologies and tools I work with to bring ideas to life.": "التقنيات والأدوات التي أعمل بها لتحويل الأفكار إلى واقع.",
        "Frontend": "الواجهة الأمامية",
        "Backend": "الخادم",
        "Mobile": "المحمول",
        "AI/ML": "الذكاء الاصطناعي",
        
        // Resume Section
        "Resume": "السيرة الذاتية",
        "My professional journey and achievements.": "رحلتي المهنية وإنجازاتي.",
        "Education": "التعليم",
        "Experience": "الخبرة",
        "Bachelor of Computer Science": "بكالوريوس علوم الحاسوب",
        "Cairo University": "جامعة القاهرة",
        "Graduated with honors. Specialized in Software Engineering and Artificial Intelligence.": "تخرجت بمرتبة الشرف. متخصص في هندسة البرمجيات والذكاء الاصطناعي.",
        "Full Stack Web Development Certification": "شهادة تطوير الويب الشامل",
        "Comprehensive training in modern web technologies and best practices.": "تدريب شامل في تقنيات الويب الحديثة وأفضل الممارسات.",
        "Senior Software Engineer": "مهندس برمجيات أول",
        "Tech Solutions Inc.": "شركة الحلول التقنية",
        "Leading a team of developers in building scalable web applications and mobile solutions for enterprise clients.": "قيادة فريق من المطورين في بناء تطبيقات ويب قابلة للتوسع وحلول محمولة لعملاء الشركات.",
        "Full Stack Developer": "مطور شامل",
        "Digital Innovations Ltd.": "شركة الابتكارات الرقمية",
        "Developed and maintained multiple web applications using React, Node.js, and cloud technologies.": "طورت وحافظت على تطبيقات ويب متعددة باستخدام React و Node.js وتقنيات السحابة.",
        "Download Resume": "تحميل السيرة الذاتية",
        
        // Blog Section
        "Latest Blog Posts": "أحدث المقالات",
        "Sharing insights and knowledge about technology and development.": "مشاركة الأفكار والمعرفة حول التكنولوجيا والتطوير.",
        "Building Scalable React Applications": "بناء تطبيقات React قابلة للتوسع",
        "Learn best practices for structuring and scaling React applications for enterprise-level projects.": "تعلم أفضل الممارسات لهيكلة وتوسيع تطبيقات React لمشاريع على مستوى الشركات.",
        "Flutter State Management Guide": "دليل إدارة الحالة في Flutter",
        "A comprehensive guide to different state management solutions in Flutter and when to use each one.": "دليل شامل لحلول إدارة الحالة المختلفة في Flutter ومتى تستخدم كل واحد.",
        "Getting Started with TensorFlow.js": "البدء مع TensorFlow.js",
        "Learn how to implement machine learning models directly in the browser using TensorFlow.js.": "تعلم كيفية تنفيذ نماذج التعلم الآلي مباشرة في المتصفح باستخدام TensorFlow.js.",
        "Read More →": "اقرأ المزيد ←",
        
        // Contact Section
        "Get In Touch": "تواصل معي",
        "Let's discuss your next project or just say hello!": "دعنا نناقش مشروعك التالي أو فقط قل مرحباً!",
        "Email": "البريد الإلكتروني",
        "Phone": "الهاتف",
        "Location": "الموقع",
        "Cairo, Egypt": "القاهرة، مصر",
        "Name": "الاسم",
        "Your Name": "اسمك",
        "your@email.com": "your@email.com",
        "Subject": "الموضوع",
        "Project Discussion": "مناقشة المشروع",
        "Message": "الرسالة",
        "Tell me about your project...": "أخبرني عن مشروعك...",
        "Send Message": "إرسال الرسالة",
        
        // Footer
        "Building the future, one line of code at a time.": "نبني المستقبل، سطر كود واحد في كل مرة.",
        "© 2024 Ahmed Rabea. All rights reserved.": "© 2024 أحمد ربيع. جميع الحقوق محفوظة."
    }
};

// Global variables
let currentLanguage = 'en';
let isDarkMode = false;

// DOM Content Loaded
document.addEventListener('DOMContentLoaded', function() {
    initializePortfolio();
});

// Initialize portfolio functionality
function initializePortfolio() {
    setupThemeToggle();
    setupLanguageToggle();
    setupMobileMenu();
    setupSmoothScrolling();
    setupNavigationHighlight();
    setupSkillBars();
    setupTypingAnimation();
    setupContactForm();
    setupIntersectionObserver();
    setupTiltEffect();
    setupParallax();
    
    // Initialize theme and language from localStorage
    loadUserPreferences();
}

// Theme Toggle Functionality
function setupThemeToggle() {
    const themeToggle = document.getElementById('themeToggle');
    
    themeToggle.addEventListener('click', function() {
        isDarkMode = !isDarkMode;
        updateTheme();
        saveUserPreferences();
    });
}

function updateTheme() {
    const html = document.documentElement;
    
    if (isDarkMode) {
        html.classList.add('dark');
    } else {
        html.classList.remove('dark');
    }
}

// Language Toggle Functionality
function setupLanguageToggle() {
    const languageToggle = document.getElementById('languageToggle');
    const langText = document.getElementById('langText');
    
    languageToggle.addEventListener('click', function() {
        currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
        updateLanguage();
        saveUserPreferences();
    });
}

function updateLanguage() {
    const html = document.documentElement;
    const langText = document.getElementById('langText');
    
    // Update HTML attributes
    html.setAttribute('lang', currentLanguage);
    html.setAttribute('dir', currentLanguage === 'ar' ? 'rtl' : 'ltr');
    
    // Update language toggle text
    langText.textContent = currentLanguage === 'en' ? 'العربية' : 'English';
    
    // Update all translatable elements
    updateTranslatableElements();
}

function updateTranslatableElements() {
    const elements = document.querySelectorAll('[data-en], [data-ar]');
    
    elements.forEach(element => {
        const key = element.getAttribute(`data-${currentLanguage}`);
        if (key && translations[currentLanguage][key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translations[currentLanguage][key];
            } else {
                element.textContent = translations[currentLanguage][key];
            }
        }
    });
}

// Mobile Menu Functionality
function setupMobileMenu() {
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    
    mobileMenuToggle.addEventListener('click', function() {
        mobileMenu.classList.toggle('hidden');
        // prevent body scroll when menu open
        if (!mobileMenu.classList.contains('hidden')) {
            document.body.style.overflow = 'hidden';
        } else {
            document.body.style.overflow = '';
        }
    });
    
    // Close mobile menu when clicking on a link
    const mobileLinks = mobileMenu.querySelectorAll('a');
    mobileLinks.forEach(link => {
        link.addEventListener('click', function() {
            mobileMenu.classList.add('hidden');
            document.body.style.overflow = '';
        });
    });

    // Close when clicking outside the menu area
    document.addEventListener('click', (e) => {
        const nav = document.querySelector('nav');
        if (!nav.contains(e.target) && !mobileMenu.classList.contains('hidden')) {
            mobileMenu.classList.add('hidden');
            document.body.style.overflow = '';
        }
    });
}

// Smooth Scrolling
function setupSmoothScrolling() {
    const navLinks = document.querySelectorAll('a[href^="#"]');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            const targetSection = document.querySelector(targetId);
            
            if (targetSection) {
                const offsetTop = targetSection.offsetTop - 80; // Account for fixed nav
                
                window.scrollTo({
                    top: offsetTop,
                    behavior: 'smooth'
                });
            }
        });
    });
}

// Navigation Highlight
function setupNavigationHighlight() {
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('nav a[href^="#"]');
    
    function updateActiveNavLink() {
        const scrollPosition = window.scrollY + 100;
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.offsetHeight;
            const sectionId = section.getAttribute('id');
            
            if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${sectionId}`) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }
    
    window.addEventListener('scroll', updateActiveNavLink);
    updateActiveNavLink(); // Call once to set initial state
}

// Skill Bars Animation
function setupSkillBars() {
    const skillBars = document.querySelectorAll('.skill-bar');
    
    function animateSkillBars() {
        skillBars.forEach(bar => {
            const width = bar.getAttribute('data-width');
            if (width && !bar.classList.contains('animate')) {
                bar.style.setProperty('--width', width + '%');
                bar.style.width = width + '%';
                bar.classList.add('animate');
            }
        });
    }
    
    // Animate when skills section comes into view
    const skillsSection = document.getElementById('skills');
    if (skillsSection) {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    setTimeout(animateSkillBars, 500);
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.5 });
        
        observer.observe(skillsSection);
    }
}

// Typing Animation
function setupTypingAnimation() {
    const typingElement = document.getElementById('typingText');
    if (!typingElement) return;
    
    const texts = {
        en: ['Software Engineer', 'Full Stack Developer' , 'AI Developer'],
        ar: ['مهندس برمجيات', 'مطور شامل', 'مطور ذكاء الاصطناعي']
    };
    
    let currentTextIndex = 0;
    let currentCharIndex = 0;
    let isDeleting = false;
    
    function typeText() {
        const currentTexts = texts[currentLanguage];
        const currentText = currentTexts[currentTextIndex];
        
        if (isDeleting) {
            typingElement.textContent = currentText.substring(0, currentCharIndex - 1);
            currentCharIndex--;
        } else {
            typingElement.textContent = currentText.substring(0, currentCharIndex + 1);
            currentCharIndex++;
        }
        
        let timeout = isDeleting ? 50 : 100;
        
        if (!isDeleting && currentCharIndex === currentText.length) {
            timeout = 2000;
            isDeleting = true;
        } else if (isDeleting && currentCharIndex === 0) {
            isDeleting = false;
            currentTextIndex = (currentTextIndex + 1) % currentTexts.length;
        }
        
        setTimeout(typeText, timeout);
    }
    
    typeText();
}

// Contact Form
function setupContactForm() {
    const contactForm = document.getElementById('contactForm');
    
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(contactForm);
            const formObject = {};
            
            formData.forEach((value, key) => {
                formObject[key] = value;
            });
            
            // Simulate form submission
            showNotification(
                currentLanguage === 'en' 
                    ? 'Message sent successfully! I\'ll get back to you soon.' 
                    : 'تم إرسال الرسالة بنجاح! سأعود إليك قريباً.',
                'success'
            );
            
            contactForm.reset();
        });
    }
}

// Intersection Observer for Animations
function setupIntersectionObserver() {
    const animatedElements = document.querySelectorAll('.animate-slideUp, .animate-fadeIn');
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, { threshold: 0.1 });
    
    animatedElements.forEach(element => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(50px)';
        element.style.transition = 'all 0.8s ease';
        observer.observe(element);
    });
}

// 3D Tilt on project cards
function setupTiltEffect() {
    const cards = document.querySelectorAll('.tilt');
    const constrain = 20;
    cards.forEach(card => {
        card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const rotateY = ((x / rect.width) - 0.5) * (constrain * 2);
            const rotateX = -((y / rect.height) - 0.5) * (constrain * 2);
            card.style.transform = `perspective(800px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        });
        card.addEventListener('mouseleave', () => {
            card.style.transform = '';
        });
    });
}

// Subtle parallax for home background
function setupParallax() {
    const home = document.getElementById('home');
    if (!home) return;
    const overlay = home.querySelector('.absolute.inset-0');
    window.addEventListener('scroll', () => {
        const offset = window.scrollY * 0.2;
        home.style.backgroundPositionY = `-${offset}px`;
        if (overlay) overlay.style.backgroundOpacity = Math.min(0.4, 0.2 + window.scrollY / 2000);
    }, { passive: true });
}

// User Preferences
function saveUserPreferences() {
    const preferences = {
        theme: isDarkMode ? 'dark' : 'light',
        language: currentLanguage
    };
    
    localStorage.setItem('portfolioPreferences', JSON.stringify(preferences));
}

function loadUserPreferences() {
    const saved = localStorage.getItem('portfolioPreferences');
    
    if (saved) {
        const preferences = JSON.parse(saved);
        
        if (preferences.theme === 'dark') {
            isDarkMode = true;
            updateTheme();
        }
        
        if (preferences.language === 'ar') {
            currentLanguage = 'ar';
            updateLanguage();
        }
    }
}

// Notification System
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full ${
        type === 'success' ? 'bg-green-500' : 
        type === 'error' ? 'bg-red-500' : 
        'bg-blue-500'
    } text-white`;
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    // Animate in
    setTimeout(() => {
        notification.classList.remove('translate-x-full');
    }, 100);
    
    // Remove after 3 seconds
    setTimeout(() => {
        notification.classList.add('translate-x-full');
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

// Utility Functions
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Performance Optimization
function optimizePerformance() {
    // Lazy load images
    const images = document.querySelectorAll('img[data-src]');
    const imageObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.src = img.dataset.src;
                img.removeAttribute('data-src');
                imageObserver.unobserve(img);
            }
        });
    });
    
    images.forEach(img => imageObserver.observe(img));
    
    // Optimize scroll events
    const optimizedScrollHandler = debounce(() => {
        // Handle scroll events
    }, 16);
    
    window.addEventListener('scroll', optimizedScrollHandler);
}

// Initialize performance optimizations
document.addEventListener('DOMContentLoaded', optimizePerformance);

// Handle visibility changes
document.addEventListener('visibilitychange', function() {
    if (document.hidden) {
        // Page is hidden, pause animations if needed
    } else {
        // Page is visible, resume animations
    }
});

// Handle resize events
window.addEventListener('resize', debounce(function() {
    // Handle responsive adjustments
}, 250));

// Keyboard Navigation
document.addEventListener('keydown', function(e) {
    // Handle keyboard shortcuts
    if (e.ctrlKey || e.metaKey) {
        switch(e.key) {
            case 'd':
                e.preventDefault();
                document.getElementById('themeToggle').click();
                break;
            case 'l':
                e.preventDefault();
                document.getElementById('languageToggle').click();
                break;
        }
    }
    
    // Handle escape key
    if (e.key === 'Escape') {
        const mobileMenu = document.getElementById('mobileMenu');
        if (!mobileMenu.classList.contains('hidden')) {
            mobileMenu.classList.add('hidden');
        }
    }
});

// Touch gestures for mobile
let touchStartX = 0;
let touchStartY = 0;

document.addEventListener('touchstart', function(e) {
    touchStartX = e.touches[0].clientX;
    touchStartY = e.touches[0].clientY;
});

document.addEventListener('touchend', function(e) {
    const touchEndX = e.changedTouches[0].clientX;
    const touchEndY = e.changedTouches[0].clientY;
    
    const deltaX = touchEndX - touchStartX;
    const deltaY = touchEndY - touchStartY;
    
    // Swipe right to left (next section)
    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
        if (deltaX < 0) {
            // Swipe left - next section
            scrollToNextSection();
        } else {
            // Swipe right - previous section
            scrollToPreviousSection();
        }
    }
});

function scrollToNextSection() {
    const sections = document.querySelectorAll('section[id]');
    const currentSection = getCurrentSection();
    const currentIndex = Array.from(sections).findIndex(section => section.id === currentSection);
    
    if (currentIndex < sections.length - 1) {
        sections[currentIndex + 1].scrollIntoView({ behavior: 'smooth' });
    }
}

function scrollToPreviousSection() {
    const sections = document.querySelectorAll('section[id]');
    const currentSection = getCurrentSection();
    const currentIndex = Array.from(sections).findIndex(section => section.id === currentSection);
    
    if (currentIndex > 0) {
        sections[currentIndex - 1].scrollIntoView({ behavior: 'smooth' });
    }
}

function getCurrentSection() {
    const sections = document.querySelectorAll('section[id]');
    const scrollPosition = window.scrollY + 100;
    
    for (let section of sections) {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;
        
        if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
            return section.id;
        }
    }
    
    return sections[0].id;
}